<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Kraken Personal — Compounding to $1M</title>
<style>
 body{margin:0;padding:24px;font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:#f6f7f9;color:#111}
 .wrap{max-width:1100px;margin:0 auto}
 h1{margin:0 0 6px;font-size:22px}
 .sub{color:#555;margin:0 0 16px}
 .badge{display:inline-block;padding:3px 8px;border-radius:999px;background:#eef1f4;color:#334155;font-size:12px}
 .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
 .push{margin-left:auto}
 .btn{border:1px solid #d0d5dd;background:#fff;border-radius:10px;padding:8px 12px;font-size:13px;cursor:pointer}
 .card{background:#fff;border:1px solid #e4e7ec;border-radius:12px;padding:12px;margin-top:16px}
 table{width:100%;border-collapse:collapse;background:#fff;border:1px solid #e4e7ec;border-radius:12px;overflow:hidden}
 thead th{font-size:12px;color:#667085;text-align:left;background:#f8f9fb;padding:10px;border-bottom:1px solid #e4e7ec}
 tbody td{padding:10px;border-bottom:1px solid #f0f1f3;font-size:13px}
 tbody tr:last-child td{border-bottom:0}
 .muted{color:#6b7280}
</style>
</head><body><div class="wrap">
  <div class="row">
    <div>
      <h1>Kraken Personal — Compounding to $1M <span id="source" class="badge">Loading…</span></h1>
      <p class="sub">Goal: ~1% net per iteration (fees ~0.24% round-trip ⇒ aim ~1.24% gross).</p>
    </div>
    <div class="push row">
      <button id="dlJson" class="btn">Download JSON</button>
      <button id="reset" class="btn">Reset (clear local)</button>
    </div>
  </div>

  <div class="card" id="kpis"></div>

  <div class="card">
    <h3 style="margin:0 0 8px;font-size:16px">Iteration Summary</h3>
    <table>
      <thead><tr>
        <th>Iteration #</th><th>Expected Amount to Invest</th><th>Expected Net Required (1%)</th>
        <th>Remaining to Invest</th><th>Actual (Net)</th><th>Time Frame</th><th>Tokens</th>
      </tr></thead>
      <tbody id="iters"></tbody>
    </table>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px;font-size:16px">Current Iteration — Trades Log</h3>
    <table>
      <thead><tr><th>Timestamp (ET)</th><th>Token</th><th>Invested ($)</th><th>Profit (Net $)</th><th>Notes</th></tr></thead>
      <tbody id="trades"></tbody>
    </table>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px;font-size:16px">Derived (Current Iteration)</h3>
    <ul id="derived" style="margin:0;padding-left:18px"></ul>
  </div>
</div>

<script>
 const $=s=>document.querySelector(s), usd=n=>Number(n||0).toLocaleString(undefined,{style:"currency",currency:"USD",maximumFractionDigits:2});
 const FEES=0.24;  // % round-trip for guidance only
 async function get(url){ const r=await fetch(url,{cache:"no-store"}); if(!r.ok) throw new Error(url+" "+r.status); return r.json(); }

 (async ()=>{
   const [iterations,trades]=await Promise.all([get("iterations.json"),get("trades.json")]);
   $("#source").textContent="Data source: remote JSON";
   iterations.sort((a,b)=>b.iteration-a.iteration);
   const cur=iterations[0];

   // KPIs
   const pct=Math.max(0,Math.min(100,(cur.actualNet/cur.expectedNet)*100));
   $("#kpis").innerHTML = `
     <div class="row" style="gap:20px;flex-wrap:wrap">
       <div><div class="muted">Current Iteration</div><div style="font-weight:700;font-size:18px">#${cur.iteration}</div><div class="muted">${cur.timeFrame||"—"}</div></div>
       <div><div class="muted">Expected Amount to Invest</div><div style="font-weight:700;font-size:18px">${usd(cur.expected)}</div></div>
       <div><div class="muted">Actual (Net) So Far</div><div style="font-weight:700;font-size:18px">${usd(cur.actualNet)}</div></div>
       <div><div class="muted">Remaining to Invest</div><div style="font-weight:700;font-size:18px">${usd(cur.remainingInvest)}</div></div>
       <div><div class="muted">Net Progress</div><div style="font-weight:700;font-size:18px">${pct.toFixed(1)}% of +${usd(cur.expectedNet)} target</div></div>
     </div>`;

   // Iterations
   $("#iters").innerHTML = iterations.map(r=>`
     <tr>
       <td><strong>#${r.iteration}</strong></td>
       <td>${usd(r.expected)}</td>
       <td>${usd(r.expectedNet)}</td>
       <td>${usd(r.remainingInvest)}</td>
       <td>${usd(r.actualNet)}${r.iteration===cur.iteration?' <span class="muted">(partial)</span>':''}</td>
       <td>${r.timeFrame||"—"}</td>
       <td>${r.tokens||""}</td>
     </tr>`).join("");

   // Trades
   $("#trades").innerHTML = trades.map(t=>`
     <tr>
       <td>${t.timestamp}</td>
       <td><strong>${t.token}</strong></td>
       <td>${usd(t.invested)}</td>
       <td>${usd(t.profit)}</td>
       <td>${t.notes||"—"}</td>
     </tr>`).join("");

   // Derived
   const remainingNet=+(cur.expectedNet-cur.actualNet).toFixed(2);
   const capitalAllocated=+(cur.expected-cur.remainingInvest).toFixed(2);
   const allocPct=Math.max(0,Math.min(100,(capitalAllocated/cur.expected)*100));
   const netNeededPct=cur.remainingInvest>0?(remainingNet/cur.remainingInvest)*100:0;
   const grossNeededPct=netNeededPct+FEES;
   $("#derived").innerHTML = `
     <li>Remaining net to 1% target: <strong>${usd(remainingNet)}</strong></li>
     <li>Capital invested so far this iteration: <strong>${usd(capitalAllocated)}</strong> (${allocPct.toFixed(1)}%)</li>
     <li>Running equity (if closed now): <strong>${usd(25000+252.46+305.93+496.33+cur.actualNet)}</strong></li>
     <li>Net needed on remaining capital: <strong>${netNeededPct.toFixed(2)}%</strong> (≈ <strong>${grossNeededPct.toFixed(2)}% gross</strong> incl. fees)</li>`;
 })().catch(e=>{
   $("#source").textContent="Error loading JSON";
   document.body.insertAdjacentHTML("beforeend", "<pre style='white-space:pre-wrap;padding:12px'>"+String(e)+"</pre>");
 });

 // helpers
 document.getElementById("dlJson").onclick=()=>Promise.all([get("iterations.json"),get("trades.json")])
  .then(([I,T])=>{ const a=document.createElement("a"); a.href="data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify({iterations:I,trades:T},null,2)); a.download="compounding-data.json"; a.click(); });
 document.getElementById("reset").onclick=()=>{ try{localStorage.removeItem("compoundingDashboardState");}catch(e){}; location.search="?reset=1&v="+Date.now(); };
</script>
</body></html>
